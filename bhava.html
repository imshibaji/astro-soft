
<html>
<head>
<title>BhavaCalc Bhava Chart Calculator </title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
</head>
<body style="font-family: sans-serif; font-size: smaller">
<p><u><strong>BhavaCalc</strong></u> <br>
Bhava Chart Calculator - By Brian Conrad<br>
<a href="http://www.indiapress.org">http://www.IndiaPress.Org</a></p>

<form NAME="BhavaCalc">
  <div align="left"><table border="1" width="69%" height="124" style="font-family: sans-serif; font-size: larger">
    <tr>
      <td width="100%" height="23" colspan="2">
	  Month: <input type="text" name="Month" size="2" value="8" tabindex="1"> 
	  Day: <input type="text" name="Day" size="2" maxlength="2" value="15" tabindex="2"> 
	  Year: <input type="text" name="Year" size="4" value="1947" tabindex="3" maxlength="4"> </td>
    </tr>
    <tr>
      <td width="100%" height="23" colspan="2">
	  Time:&nbsp; <input type="text" name="Hour" size="2" value="0" maxlength="2" tabindex="4"> : 
	  <input type="text" name="Min" size="2" value="00" maxlength="2" tabindex="5">
	  Zone:<input type="text" name="ZHour" size="2" value="0" maxlength="2" tabindex="6"> : 
	  <input type="text" name="ZMin" size="2" value="0" maxlength="2" tabindex="7">&nbsp;
	  <input type="checkbox" name="DST" value="DST" tabindex="8"> DST</td>
    </tr>
    <tr>
      <td width="48%" height="29">Longitude: 
	  <input type="text" name="LonDeg" size="3" value="77" maxlength="3" tabindex="9"> : 
	  <input type="text" name="LonMin" size="2" value="13" maxlength="2" tabindex="10">
      <input type="checkbox" name="East" value="East" tabindex="11">East</td>
      <td width="52%" height="29">Latitude: 
	  <input type="text" name="LatDeg" size="2" value="28" maxlength="2" tabindex="12"> : 
	  <input type="text" name="LatMin" size="2" value="29" maxlength="2" tabindex="13">
	  <input type="checkbox" name="South" value="South" tabindex="14">South</td>
    </tr>
    <tr>
      <td width="100%" height="25" colspan="2"><div align="center"><center><p><big><input type="button" value="Calculate" name="Calculate" onClick="calculate()"></big></td>
    </tr>
  </table>
  </div>
</form>

<form method="POST" name="AscMid" action="bhavcalc.htm" webbot-action="--WEBBOT-SELF--">
  <div align="left"><table border="1" width="69%" style="font-family: sans-serif; font-size: larger">
    <tr>
      <td width="19%">Julian Day:</td>
      <td width="27%" align="center"><input type="text" name="JulDay" size="16"></td>
      <td width="27%" align="center">Ayanamsa</td>
      <td width="27%" align="center"><input type="text" name="Ayan" size="16"></td>
    </tr>
    <tr>
      <td width="19%"><div align="center"><center><p>Ascendant</td>
      <td width="27%" align="center"><input type="text" name="Asc" size="16"></td>
      <td width="27%" align="center"><div align="center"><center><p>Midheaven</td>
      <td width="27%" align="center"><input type="text" name="MidHvn" size="16"></td>
    </tr>
  </table>
  </div><div align="center"><center><table border="1" width="69%" align="left" style="font-family: sans-serif; font-size: larger">
    <tr>
      <td width="15%" align="center">House</td>
      <td width="39%"><div align="center"><center><p>Bhava Madhya</td>
      <td width="46%" align="center"><div align="center"><center><p>Bhava Sandhi</td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">1</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad1" size="16"></td>
      <td width="46%" align="center"><div align="center"><center><p><input type="text" name="Snd1" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">2</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad2" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd2" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">3</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad3" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd3" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">4</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad4" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd4" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">5</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad5" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd5" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">6</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad6" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd6" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">7</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad7" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd7" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">8</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad8" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd8" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">9</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad9" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd9" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">10</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad10" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd10" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">11</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad11" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd11" size="16"></td>
    </tr>
    <tr align="center">
      <td width="15%" align="center">12</td>
      <td width="39%"><div align="center"><center><p><input type="text" name="Mad12" size="16"></td>
      <td width="46%" align="center"><input type="text" name="Snd12" size="16"></td>
    </tr>
  </table>
  </center></div>
</form>
<script language="JavaScript">
zn = "AriTauGemCanLeoVirLibScoSagCapAquPis";  // Zodiac 
d2r = Math.PI/180;	// degrees to radians
r2d = 180/Math.PI;	// radians to degrees
var range = [1,12,1,31,1800,2100,0,23,0,59,0,12,0,59,0,0,0,179,0,59,0,0,0,89,0,59]; 	


function checkEntries(f){

	for(i = 0; i < 13; i++){
		var e = f.elements[i];
		if((e.name == "DST") || (e.name == "East") || (e.name == "South"))continue;
		if(isNaN(e.value) || (e.value < range[i*2] ) || ( e.value > range[i*2+1])){
			msg = "Please enter value between " 
				+ range[i*2] + " and " + range[i*2+1] 
				+ " in the " + e.name + " field";
			alert(msg);
			return true;
		}
	}
	return false;
}


function calculate()
{
	if(checkEntries(document.BhavaCalc))return;
	
	with(Math){
		var mon = floor(document.BhavaCalc.Month.value);
		var day = floor(document.BhavaCalc.Day.value);
		var year= floor(document.BhavaCalc.Year.value);
		var hr= floor(document.BhavaCalc.Hour.value);
		hr	+= floor(document.BhavaCalc.Min.value)/60;
		var tz= floor(document.BhavaCalc.ZHour.value);
		tz += floor(document.BhavaCalc.ZMin.value)/60;
		var ln= floor(document.BhavaCalc.LonDeg.value);
		ln += floor(document.BhavaCalc.LonMin.value)/60;
		var la= floor(document.BhavaCalc.LatDeg.value);
		la += floor(document.BhavaCalc.LatMin.value)/60;
	}
	// checks for checked DST, East, South
	var dst = document.BhavaCalc.DST;
	var eln = document.BhavaCalc.East;
	var sla = document.BhavaCalc.South;
	
	if(eln.checked)ln = -ln;
	if(sla.checked)la = -la;
	if(dst.checked){
		if(ln < 0.0)tz++;
		else tz--;
	}

	jd = mdy2julian(mon,day,year);
	if(ln < 0.0)f = hr - tz;
	else f = hr+tz;
	
	t = ((jd - 2415020) + f/24 - 0.5)/36525;
	ay = calcAyanamsa(t);
	document.AscMid.JulDay.value = jd;
	document.AscMid.Ayan.value = writedms(ay);

	ra = (((6.6460656 + 2400.0513 * t + 2.58e-5 * t * t + f) * 15 - ln) % 360) * d2r; // RAMC
	ob = (23.452294 - 0.0130125 * t) * d2r; // Obliquity of Ecliptic
	with(Math){
		// Calculate Midheaven
		mc = atan2(tan(ra),cos(ob));
		if(mc < 0.0)mc += PI;
		if(sin(ra) < 0.0)mc += PI
		mc *= r2d;
		
		// Calculate Ascendant
		as = atan2(cos(ra),-sin(ra)*cos(ob)-tan(la * d2r)*sin(ob));
		if(as < 0.0)as += PI;
		if(cos(ra) < 0.0)as += PI;
		as *= r2d % 360.0;
	}
	// add Ayanamsa
	as += ay; mc += ay;
	document.AscMid.Asc.value = lon2dmsz(as);
	document.AscMid.MidHvn.value = lon2dmsz(mc);

	// calculate bhavas as per 
	// Deepak Kapoor's "Astronomy and Mathematical Astrology" - 1997 Ranjan Pub.
 
	var hs = new Array(24);
	x = as - mc;
	if(x < 0.0)x += 360.0;
	x /= 6;
	y = 18; // 10th house in the array
	for(i = 0; i < 7; i++){
		hs[y] = mc + x * i;
		y++;
		if(y > 24)y = 0; 
	}  		
	x = mc - fix360(as + 180.0);
	if(x < 0.0)x += 360.0;
	x /= 6;
	y = 12;
	for(i = 0; i < 7; i++){
		hs[y] = fix360(as + 180 + x * i);
		y++;
	}

	for(i = 0; i < 12; i++){
		hs[i] = fix360(hs[i+12] + 180);
	}
	var s;
	z = 0;
	
	// Fill Out Madhya Values in Form
	document.AscMid.Mad1.value = lon2dmsz(hs[0]);
	document.AscMid.Mad2.value = lon2dmsz(hs[2]);
	document.AscMid.Mad3.value = lon2dmsz(hs[4]);
	document.AscMid.Mad4.value = lon2dmsz(hs[6]);
	document.AscMid.Mad5.value = lon2dmsz(hs[8]);
	document.AscMid.Mad6.value = lon2dmsz(hs[10]);
	document.AscMid.Mad7.value = lon2dmsz(hs[12]);
	document.AscMid.Mad8.value = lon2dmsz(hs[14]);
	document.AscMid.Mad9.value = lon2dmsz(hs[16]);
	document.AscMid.Mad10.value = lon2dmsz(hs[18]);
	document.AscMid.Mad11.value = lon2dmsz(hs[20]);
	document.AscMid.Mad12.value = lon2dmsz(hs[22]);

	// Fill Out Madhya Values in Form
	document.AscMid.Snd1.value = lon2dmsz(hs[1]);
	document.AscMid.Snd2.value = lon2dmsz(hs[3]);
	document.AscMid.Snd3.value = lon2dmsz(hs[5]);
	document.AscMid.Snd4.value = lon2dmsz(hs[7]);
	document.AscMid.Snd5.value = lon2dmsz(hs[9]);
	document.AscMid.Snd6.value = lon2dmsz(hs[11]);
	document.AscMid.Snd7.value = lon2dmsz(hs[13]);
	document.AscMid.Snd8.value = lon2dmsz(hs[15]);
	document.AscMid.Snd9.value = lon2dmsz(hs[17]);
	document.AscMid.Snd10.value = lon2dmsz(hs[19]);
	document.AscMid.Snd11.value = lon2dmsz(hs[21]);
	document.AscMid.Snd12.value = lon2dmsz(hs[23]);

}


// Calculate the Lahiri Ayanamsa by using Erlewine Fagan-Bradley sidereal calculation
// with correction using Lahiri 1900 value in minutes (see below)
function calcAyanamsa(t)
{
	ln = ((933060-6962911*t+7.5*t*t)/3600.0) % 360.0;  /* Mean lunar node */
	Off = (259205536.0*t+2013816.0)/3600.0;             /* Mean Sun        */
	Off = 17.23*Math.sin(d2r * ln)+1.27*Math.sin(d2r * Off)-(5025.64+1.11*t)*t;
	Off = (Off- 80861.27)/3600.0;  // 84038.27 = Fagan-Bradley 80861.27 = Lahiri
	return Off;
}

// calculate Julian Day from Month, Day and Year
function mdy2julian(m,d,y)
{
	with(Math){
		im = 12 * (y + 4800) + m - 3;
		j = (2 * (im - floor(im/12) * 12) + 7 + 365 * im)/12;
		j = floor(j) + d + floor(im/48) - 32083;
		if(j > 2299171)j += floor(im/4800) - floor(im/1200) + 38;
		return j;	
	}
}

// build string with degrees, minutes, seconds and zodiac sign from longitude
function lon2dmsz(x)
{
	with(Math){
		var d,m,s;
		x = abs(x);
		d = floor(x);
		m = (x - d);
		s = m * 60;
		m = floor(s);
		s = s - m;
		z = floor(d/30);
		d %= 30;
		str = d + "° " + m + "' " + floor(s * 60) + "\" " + zn.substr(z*3,3);	
	}
	return str;
}

// write degrees minutes
function writedms(x) {
	with(Math){
		var d,m,s;
		if(x < 0.0)sgn = -1;
		else sgn = 1;
		x = abs(x);
		d = floor(x);
		m = (x - d);
		s = m * 60;
		m = floor(s);
		s = s - m;
		str =  (d*sgn) + "° " + m + "' " + floor(s * 60) + "\"";
	}
	return str;
}

// keep within 360 degrees
function fix360(v)
{
	if(v < 0.0)v += 360;
	if(v > 360)v -= 360;
	return v;
}

</script>
<!-- Begin comScore Tag -->
<script>
  var _comscore = _comscore || [];
  _comscore.push({ c1: "2", c2: "18904020" });
  (function() {
    var s = document.createElement("script"), el = document.getElementsByTagName("script")[0]; s.async = true;
    s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
    el.parentNode.insertBefore(s, el);
  })();
</script>
<noscript>
  <img src="http://b.scorecardresearch.com/p?c1=2&c2=18904020&cv=2.0&cj=1" />
</noscript>
<!-- End comScore Tag -->

</body>
</html>
